import{P as v,r as a,C as D,j as e,Q as E,m as P,B as w,h as R,u as B,a as M,s as I}from"./index-W29gIuby.js";import{L as _,C as q,T as V}from"./loaderSpinner-DB2fz_yz.js";import{A as z}from"./AdminLayout-BAzsrnU5.js";import{b as L,a as H}from"./index-DYVT73-p.js";import{I as S}from"./index-CejQMpiJ.js";import{T as O}from"./utils-Ug9IFQHp.js";import{T as $}from"./index-DS57sa4y.js";import"./index-BYU5Di5h.js";import"./iconBase-DaNi9Cxe.js";const T=({setOpenEdit:n})=>{const x=a.useRef(""),h=a.useRef(""),l=a.useRef(""),g=a.useRef(""),[N,b]=a.useState([]),u=a.useRef(null),m=a.useRef(null),{editObj:s}=a.useContext(D),[y,c]=a.useState(!1),j=async i=>{i.preventDefault();try{c(!0);const o=new FormData;o.append("name",x.current.value),o.append("price",h.current.value),o.append("image",l.current.files[0]),o.append("description",g.current.value),o.append("category",u.current.value),console.log(o);const r=await P.post("https://radiant-whispersstore.onrender.com/api/products/addProduct",o,{headers:{"Content-Type":"multipart/form-data"}});r.data.created?w.success(r.data.message):w.error(r.data.message)}catch(o){console.log(o)}finally{c(!1)}},f=a.useCallback(i=>{m.current&&!m.current.contains(i.target)&&n(!1)},[m,n]);a.useEffect(()=>(document.addEventListener("click",f),()=>{document.removeEventListener("click",f)}),[f]);const d=async(i,o)=>{let r=new FileReader;const t=i.target.files[0];r.onload=async()=>{if(o.length>0){const p=r.result;b(p)}},r.readAsDataURL(t)};a.useEffect(()=>{b(s==null?void 0:s.image)},[s]);const k=async(i,o)=>{i.preventDefault();try{c(!0);const r=new FormData;r.append("name",x.current.value),r.append("price",h.current.value),r.append("image",l.current.files[0]),r.append("description",g.current.value),r.append("category",u.current.value),console.log(r);const t=await P.post(`https://radiant-whispersstore.onrender.com/api/products/edit/${o}`,r,{headers:{"Content-Type":"multipart/form-data"}});console.log(t.data),t.data.created?w.success(t.data.message):t.data.error_type===0?w.error(t.data.error[0].msg):t.data.error_type===1&&w.error(t.data.message)}catch(r){console.log(r)}finally{c(!1)}},C=()=>{n(!1)};return e.jsxs("div",{className:"fixed inset-0 p-10 flex justify-center  bg-gray-800 bg-opacity-90 z-50",ref:m,children:[e.jsx(E,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsxs("form",{onSubmit:j,className:"forgot-password xl:w-1/4 w-full p-2 lg:w-3/4 2xl:w-1/4 min-h-full md:w-3/4 sm:w-3/4 rounded-lg   shadow-md bg-[#891980] transition duration-500 ease-in-out border-2 border-transparent overflow-auto",children:[e.jsx("div",{className:"flex justify-end cursor-pointer",children:e.jsx(L,{onClick:C})}),e.jsx("h2",{className:"text-center text-2xl mt-3 mb-3 text-white",children:"Add product"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm text-white font-medium ",children:"Name"}),e.jsx("input",{ref:x,type:"text",id:"name",defaultValue:s==null?void 0:s.name,className:"mt-1 p-2 block text-[12px] w-full border border-white rounded-md focus:outline-none focus:border-pink-500",placeholder:"Enter Product Name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-white mt-2",children:"Price"}),e.jsx("input",{ref:h,type:"text",id:"price",defaultValue:s==null?void 0:s.price,className:"mt-1 p-2 text-[12px] block w-full border border-white rounded-md focus:outline-none focus:border-pink-500",placeholder:"Enter price"})]}),e.jsx("label",{htmlFor:"category ",className:"text-white",children:"Category:"}),e.jsxs("select",{id:"category",defaultValue:s==null?void 0:s.category,name:"category",ref:u,className:"text-sm mt-4 bg-white border-2 p-2 ml-3 rounded-xl mb-4",children:[e.jsx("option",{value:"body cream",children:"body cream"}),e.jsx("option",{value:"face cream",children:"face cream"}),e.jsx("option",{value:"body wash",children:"body wash"})]}),e.jsxs("div",{className:"mt-3 mb-3 flex p-2 gap-2 items-center w-full text-[12px] border-pink-700 bg-[#f29cb3] border-2 rounded-sm focus:outline-none focus:border-pink-500",children:[e.jsx(H,{className:"cursor-pointer"}),e.jsx("input",{type:"file",id:"image",name:"image",style:{visibility:"hidden",width:"0",height:"0"},ref:l,onChange:i=>d(i,i.target.files)}),e.jsx("label",{htmlFor:"image",className:"cursor-pointer",children:"Select Product Image"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-white",children:"Description"}),e.jsx("textarea",{ref:g,id:"description",className:"mt-1 mb-4 p-2 block text-[12px] w-full border h-40 border-white rounded-md focus:outline-none focus:border-pink-500",placeholder:"Enter Product Description",maxLength:200,defaultValue:s==null?void 0:s.description})]}),e.jsxs("button",{id:s==null?void 0:s._id,onClick:i=>k(i,s==null?void 0:s._id),type:"submit",className:"w-full mb-4 border-2 bg-[#f29cb3] flex items-center justify-center border-pink-700 hover:text-white hover:bg-pink-700 py-2 px-4 rounded-md transition duration-300 ease-in-out transform hover:scale-105",children:["Edit Product",y&&e.jsx(S,{className:"animate-spin"})]}),e.jsx("div",{className:"w-full h-[400px] border bg-white mb-32",children:e.jsx("img",{style:{width:"100%",height:"100%"},src:N,alt:""})})]})]})};T.propTypes={setOpenEdit:v.func.isRequired};const F=({deleteName:n,closeDeleteModal:x,setOpenDelete:h})=>{const l=a.useRef(""),g=a.useRef(null),[N,b]=a.useState(!1),[u,m]=a.useState(!1),{loadUser:s}=a.useContext(D);a.useEffect(()=>{s()},[]),a.useEffect(()=>{const c=()=>{l.current&&m(l.current.value===n.name)};return l.current&&l.current.addEventListener("input",c),()=>{l.current&&l.current.removeEventListener("input",c)}},[n.name]);const y=async c=>{c.preventDefault(),b(!0);const j=n==null?void 0:n.id,f=new FormData;f.append("id",j);try{const d=await R.delete(`/api/product/deleteOne/${j}`,f,{headers:{"Content-Type":"application/json"}});d.data.created?(w.success(d.data.message),h(!1),location.reload()):w.error(d.data.message)}catch(d){console.log(d)}finally{b(!1)}};return e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center bg-gray-800 bg-opacity-90 z-50",ref:g,children:[e.jsx(E,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsxs("form",{onSubmit:y,className:"forgot-password  xl:w-1/4 w-full p-3 lg:w-3/4 2xl:w-1/4 md:w-3/4 sm:w-3/4 rounded-lg shadow-md bg-pink-200 transition duration-500 ease-in-out border-2 border-transparent",children:[e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:x,children:e.jsx(L,{})})}),e.jsxs("h1",{className:"text-[13px]",children:["Please type the product name to confirm: ",e.jsxs("span",{className:"text-[14px] font-extrabold",children:[" ",n==null?void 0:n.name]})]}),e.jsx("input",{ref:l,placeholder:"type here",className:"w-full p-2 mt-2"}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{className:"border-2 w-20 h-10 px-3 rounded-md flex items-center justify-center gap-3",style:{backgroundColor:u?"red":"#ccc"},disabled:!u,onClick:y,children:N?e.jsx(S,{className:"animate-spin"}):"Delete"})})]})]})};F.propTypes={deleteName:v.shape({name:v.string.isRequired,id:v.string.isRequired}).isRequired,closeDeleteModal:v.func.isRequired,setOpenDelete:v.func.isRequired};function ee(){const[n,x]=a.useState(!1),{openEdit:h,setOpenEdit:l,setEditobj:g}=a.useContext(D),[N,b]=a.useState(!1),u=B(t=>t.products),[m,s]=a.useState(20),[y,c]=a.useState(!1),[j,f]=a.useState({name:"",id:""}),d=M(),k=async()=>{try{return x(!0),await(await R.get("/api/products/allProducts")).data.products}catch(t){return console.log(t),[]}finally{x(!1),b(!1)}};a.useEffect(()=>{k().then(t=>{d(I(t))})},[d]);const C=()=>{s(t=>t+10)},i=async t=>{try{const A=await(await R.get(`/api/products/edit/${t}`)).data.product;g(A)}catch(p){console.log(p)}finally{l(!0)}},o=(t,p)=>{c(!0),f({name:t,id:p})},r=()=>{c(!1),f({name:"",id:""})};return e.jsxs(z,{children:[h&&e.jsx(T,{setOpenEdit:l}),y&&e.jsx(F,{deleteName:j,closeDeleteModal:r,setOpenDelete:c}),e.jsxs("main",{className:"mb-10 xl:mt-40 lg:mt-44 md:mt-32 sm:mt-84 mt-40",children:[n&&e.jsx(_,{}),e.jsxs("div",{className:"xl:w-4/5 w-full   mx-auto  lg:p-4 md:p-5",children:[e.jsx("div",{className:" flex  w-full sm:gap-5 flex-wrap  sm:flex-wrap justify-evenly   xl:justify-center  2xl:justify-evenly ",children:u.slice(0,m).map((t,p)=>e.jsxs("div",{className:" mb-20 max-w-48 xl:w-48  h-84  ",children:[e.jsx("div",{className:"  w-full h-52 shadow-xl  overflow-hidden  border-2 rounded-lg mb-3 relative",children:e.jsx("img",{src:t==null?void 0:t.image,className:"w-full h-full",alt:""})}),e.jsxs("div",{className:"p-1 ",children:[e.jsx("h3",{className:"text-[13px]",children:O(t==null?void 0:t.name,23)}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{}),e.jsxs("h4",{className:"text-md",children:[e.jsx("span",{}),t==null?void 0:t.price]})]})]}),e.jsxs("div",{className:"flex justify-between  ",children:[e.jsx("div",{className:"justify-center flex ",children:e.jsx("button",{onClick:()=>o(t==null?void 0:t.name,t==null?void 0:t._id),className:"text-[12px]  border  px-6 rounded-md text-white p-2 bg-pink-700 ",children:"Delete"})}),e.jsx("button",{id:t._id,className:"border text-sm px-6 rounded-md   bg-[#891980] border-pink-600 text-white hover:bg-pink-950",onClick:()=>i(t==null?void 0:t._id),children:"Edit"})]})]},p))}),N&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[e.jsx(q,{size:80,style:{marginBottom:20,color:"#F13DA6"}}),e.jsx(V,{variant:"h6",className:"text-pink-700 text-xl absolute ",style:{textAlign:"center"},children:"Radiantwhispersstore products..."})]}),e.jsx("div",{className:"m-auto w-44",children:!n&&m<u.length&&e.jsx("button",{onClick:C,className:"w-52 border p-2 rounded-xl bg-[#fd00cd] text-white font-bold",children:n?"Loading...":"Load More"})})]}),e.jsx(E,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})]})}export{ee as default};
